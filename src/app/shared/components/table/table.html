<div class="toolbar-container">
  <mat-form-field class="table-search" [class]="searchbarClass()" appearance="outline">
    <mat-icon matPrefix>search</mat-icon>
    <input
      matInput
      [value]="filterValue()"
      (keyup)="onFilterKeyup($event)"
      placeholder="Search"
      #searchInput
    />
    @if (filterValue()) {
      <button
        type="button"
        matIconButton
        matSuffix
        (click)="$event.stopPropagation(); onSearchClear(searchInput)"
        aria-label="Clear Search Input"
      >
        <mat-icon>close</mat-icon>
      </button>
    }
  </mat-form-field>
  <ng-content select="[toolbarActions]"></ng-content>
</div>
<div class="table-container" [class]="tableContainerClass()">
  @if (isLoading()) {
    <div class="spinner-container">
      <mat-progress-spinner mode="indeterminate" diameter="40"></mat-progress-spinner>
    </div>
  }
  <mat-table
    matSort
    [dataSource]="dataSource()"
    class="mat-elevation-z1"
    [style.display]="isLoading() ? 'none' : 'block'"
  >
    @for (column of columns(); track column.columnDef) {
      <ng-container [matColumnDef]="column.columnDef">
        <mat-header-cell *matHeaderCellDef mat-sort-header>
          {{ column.header }}
        </mat-header-cell>
        <mat-cell
          *matCellDef="let element"
          [matTooltip]="column.cellTemplate ? null : column.cell(element)"
        >
          @if (column.cellTemplate) {
            <ng-container
              [ngTemplateOutlet]="column.cellTemplate"
              [ngTemplateOutletContext]="{ value: column.cell(element) }"
            ></ng-container>
          } @else {
            {{ column.cell(element) }}
          }
        </mat-cell>
      </ng-container>
    }
    <mat-header-row *matHeaderRowDef="displayedColumns(); sticky: true"></mat-header-row>
    <mat-row *matRowDef="let row; columns: displayedColumns()"></mat-row>

    <!-- Row shown when there is no matching data. -->
    <tr class="mat-row" *matNoDataRow>
      <td class="mat-cell" colspan="6">
        <p class="no-data-row-text">
          @if (searchInput.value) {
            No data matching the filter "{{ searchInput.value }}"
          } @else {
            No data available
          }
        </p>
      </td>
    </tr>
  </mat-table>
</div>
